---
import EventDetailPage from '../../views/EventDetailPage.astro';
import { getReleaseData } from '../../lib/release-data';
import { withBasePath } from '../../lib/paths';

export function getStaticPaths() {
  const { eventsData } = getReleaseData('main');
  return eventsData.events.map((event) => ({
    params: { eventId: event.id },
  }));
}

const { eventId } = Astro.params;
const { release, pluginData, filtersData, eventsData } = getReleaseData('main');
const event = eventsData.events.find((e) => e.id === eventId);

if (!event) {
  return Astro.redirect(withBasePath(release.basePath, '/events'));
}
---

<EventDetailPage
  release={release}
  pluginData={pluginData}
  filtersData={filtersData}
  eventsData={eventsData}
  event={event}
/>
