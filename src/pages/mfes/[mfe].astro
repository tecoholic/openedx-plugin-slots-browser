---
import MfeDetailPage from '../../views/MfeDetailPage.astro';
import { getReleaseData } from '../../lib/release-data';
import { withBasePath } from '../../lib/paths';

export function getStaticPaths() {
  const { pluginData } = getReleaseData('main');
  return pluginData.mfes.map((mfe) => ({
    params: { mfe: mfe.id },
  }));
}

const { mfe } = Astro.params;
const { release, pluginData, filtersData, eventsData } = getReleaseData('main');
const mfeInfo = pluginData.mfes.find((m) => m.id === mfe);
const slots = pluginData.pluginSlots.filter((s) => s.mfeId === mfe);

if (!mfeInfo) {
  return Astro.redirect(withBasePath(release.basePath, '/mfes'));
}
---

<MfeDetailPage
  release={release}
  pluginData={pluginData}
  filtersData={filtersData}
  eventsData={eventsData}
  mfeInfo={mfeInfo}
  slots={slots}
/>
